{"openapi":"3.1.0","info":{"title":"Xubudget PI2 API","description":"Sistema completo de controle financeiro com budgets subcategorizados","version":"2.0.0"},"paths":{"/api/healthz":{"get":{"summary":"Health Check","operationId":"health_check_api_healthz_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/state":{"get":{"summary":"Get State","operationId":"get_state_api_state_get","parameters":[{"name":"user_id","in":"query","required":false,"schema":{"type":"string","default":"default","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/set_budget":{"post":{"summary":"Set Budget","operationId":"set_budget_api_set_budget_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SetBudgetRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserState"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/add_expense":{"post":{"summary":"Add Expense","operationId":"add_expense_api_add_expense_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AddExpenseRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserState"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/expenses":{"get":{"summary":"Get Expenses","operationId":"get_expenses_api_expenses_get","parameters":[{"name":"user_id","in":"query","required":false,"schema":{"type":"string","default":"default","title":"User Id"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":20,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/expense/reclassify":{"post":{"summary":"Api Expense Reclassify","description":"Reclassifica uma despesa recente. Compat: usa expense_id como indice 1-based na lista ordenada por timestamp desc.\nSe new_amount vier, atualiza tambem o valor.","operationId":"api_expense_reclassify_api_expense_reclassify_post","parameters":[{"name":"learn","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Learn"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExpenseReclassify"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/get_icons":{"get":{"summary":"Get Icons","operationId":"get_icons_api_get_icons_get","parameters":[{"name":"user_id","in":"query","required":false,"schema":{"type":"string","default":"default","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/IconState"},"title":"Response Get Icons Api Get Icons Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/icons":{"get":{"summary":"Get Icons Alias","description":"Alias para compatibilidade com o frontend: retorna os mesmos ├¡cones de /api/get_icons.","operationId":"get_icons_alias_api_icons_get","parameters":[{"name":"user_id","in":"query","required":false,"schema":{"type":"string","default":"default","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/IconState"},"title":"Response Get Icons Alias Api Icons Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/activate_icon":{"post":{"summary":"Activate Icon","operationId":"activate_icon_api_activate_icon_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/IconActivationRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserState"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/budget_structure":{"get":{"summary":"Api Budget Structure","description":"Retorna estrutura completa de budgets hier├â┬írquicos","operationId":"api_budget_structure_api_budget_structure_get","parameters":[{"name":"user_id","in":"query","required":false,"schema":{"type":"string","default":"default","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/set_subcategory_budget_v2":{"post":{"summary":"Api Set Subcategory Budget V2","description":"Define budget para subcategoria espec├â┬¡fica","operationId":"api_set_subcategory_budget_v2_api_set_subcategory_budget_v2_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubcategoryBudget"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/set_category_budget":{"post":{"summary":"Api Set Category Budget","operationId":"api_set_category_budget_api_set_category_budget_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CatBudgetSet"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/add_income":{"post":{"summary":"Api Add Income","operationId":"api_add_income_api_add_income_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/IncomeAdd"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/incomes":{"get":{"summary":"Api Incomes","operationId":"api_incomes_api_incomes_get","parameters":[{"name":"user_id","in":"query","required":false,"schema":{"type":"string","default":"default","title":"User Id"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":50,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/set_budget_mode":{"post":{"summary":"Api Set Budget Mode","operationId":"api_set_budget_mode_api_set_budget_mode_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BudgetMode"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/ai/rules":{"get":{"summary":"Api Ai Rules","operationId":"api_ai_rules_api_ai_rules_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/ai/learn_merchant_category":{"post":{"summary":"Api Ai Learn","operationId":"api_ai_learn_api_ai_learn_merchant_category_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MerchantLearnPayload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chat_legacy":{"post":{"summary":"Chat Endpoint","operationId":"chat_endpoint_api_chat_legacy_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chat":{"post":{"summary":"Chat Endpoint2","operationId":"chat_endpoint2_api_chat_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/categories":{"get":{"summary":"Api Categories","operationId":"api_categories_api_categories_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/safe_to_spend":{"get":{"summary":"Api Safe To Spend","operationId":"api_safe_to_spend_api_safe_to_spend_get","parameters":[{"name":"user_id","in":"query","required":false,"schema":{"type":"string","default":"default","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/timeline":{"get":{"summary":"Api Timeline","operationId":"api_timeline_api_timeline_get","parameters":[{"name":"user_id","in":"query","required":false,"schema":{"type":"string","default":"default","title":"User Id"}},{"name":"days","in":"query","required":false,"schema":{"type":"integer","default":30,"title":"Days"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":200,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/daily_briefing":{"get":{"summary":"Api Daily Briefing","operationId":"api_daily_briefing_api_daily_briefing_get","parameters":[{"name":"user_id","in":"query","required":false,"schema":{"type":"string","default":"default","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/dashboard_summary":{"get":{"summary":"Api Dashboard Summary","operationId":"api_dashboard_summary_api_dashboard_summary_get","parameters":[{"name":"user_id","in":"query","required":false,"schema":{"type":"string","default":"default","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/memory":{"get":{"summary":"Api Get Memory","operationId":"api_get_memory_api_memory_get","parameters":[{"name":"user_id","in":"query","required":false,"schema":{"type":"string","default":"default","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"summary":"Api Add Memory","operationId":"api_add_memory_api_memory_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MemoryItem"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/rag/add":{"post":{"summary":"Api Rag Add","operationId":"api_rag_add_api_rag_add_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RagDoc"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/rag/search":{"get":{"summary":"Api Rag Search","operationId":"api_rag_search_api_rag_search_get","parameters":[{"name":"q","in":"query","required":true,"schema":{"type":"string","title":"Q"}},{"name":"k","in":"query","required":false,"schema":{"type":"integer","default":3,"title":"K"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/ollama_test":{"post":{"summary":"Api Ollama Test","operationId":"api_ollama_test_api_ollama_test_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LlmTest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"AddExpenseRequest":{"properties":{"user_id":{"type":"string","title":"User Id","default":"default"},"amount":{"type":"number","exclusiveMinimum":0.0,"title":"Amount"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"merchant":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Merchant"},"category":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Category"},"subcategory":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Subcategory"}},"type":"object","required":["amount"],"title":"AddExpenseRequest"},"BudgetMode":{"properties":{"user_id":{"type":"string","title":"User Id","default":"default"},"mode":{"type":"string","title":"Mode"}},"type":"object","required":["mode"],"title":"BudgetMode"},"CatBudgetSet":{"properties":{"user_id":{"type":"string","title":"User Id","default":"default"},"category":{"type":"string","title":"Category"},"budget":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Budget"}},"type":"object","required":["category"],"title":"CatBudgetSet"},"ChatRequest":{"properties":{"user_id":{"type":"string","title":"User Id","default":"default"},"message":{"type":"string","title":"Message"}},"type":"object","required":["message"],"title":"ChatRequest"},"ExpenseReclassify":{"properties":{"user_id":{"type":"string","title":"User Id","default":"default"},"expense_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Expense Id"},"new_category":{"type":"string","title":"New Category"},"new_amount":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"New Amount"}},"type":"object","required":["new_category"],"title":"ExpenseReclassify"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"IconActivationRequest":{"properties":{"user_id":{"type":"string","title":"User Id","default":"default"},"category_id":{"type":"string","title":"Category Id"},"amount":{"type":"number","title":"Amount"}},"type":"object","required":["category_id","amount"],"title":"IconActivationRequest"},"IconState":{"properties":{"id":{"type":"string","title":"Id"},"name":{"type":"string","title":"Name"},"emoji":{"type":"string","title":"Emoji"},"budget":{"type":"number","title":"Budget"},"spent":{"type":"number","title":"Spent","default":0.0},"active":{"type":"boolean","title":"Active","default":false}},"type":"object","required":["id","name","emoji","budget"],"title":"IconState"},"IncomeAdd":{"properties":{"user_id":{"type":"string","title":"User Id","default":"default"},"amount":{"type":"number","exclusiveMinimum":0.0,"title":"Amount"},"source":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Source"}},"type":"object","required":["amount"],"title":"IncomeAdd"},"LlmTest":{"properties":{"prompt":{"type":"string","title":"Prompt","default":"ol├í"}},"type":"object","title":"LlmTest"},"MemoryItem":{"properties":{"user_id":{"type":"string","title":"User Id","default":"default"},"text":{"type":"string","title":"Text"},"tags":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Tags"}},"type":"object","required":["text"],"title":"MemoryItem"},"MerchantLearnPayload":{"properties":{"merchant":{"type":"string","title":"Merchant"},"category":{"type":"string","title":"Category"}},"type":"object","required":["merchant","category"],"title":"MerchantLearnPayload"},"RagDoc":{"properties":{"title":{"type":"string","title":"Title"},"text":{"type":"string","title":"Text"},"meta":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Meta"}},"type":"object","required":["title","text"],"title":"RagDoc"},"SetBudgetRequest":{"properties":{"user_id":{"type":"string","title":"User Id","default":"default"},"budget":{"type":"number","minimum":0.0,"title":"Budget"}},"type":"object","required":["budget"],"title":"SetBudgetRequest"},"SubcategoryBudget":{"properties":{"user_id":{"type":"string","title":"User Id","default":"default"},"category":{"type":"string","title":"Category"},"subcategory":{"type":"string","title":"Subcategory"},"monthly_budget":{"type":"number","minimum":0.0,"title":"Monthly Budget"}},"type":"object","required":["category","subcategory","monthly_budget"],"title":"SubcategoryBudget"},"UserState":{"properties":{"user_id":{"type":"string","title":"User Id"},"budget":{"type":"number","title":"Budget","default":0.0},"monthly_spent":{"type":"number","title":"Monthly Spent","default":0.0},"remaining":{"type":"number","title":"Remaining","default":0.0},"history":{"items":{"type":"object"},"type":"array","title":"History"},"category_budgets":{"type":"object","title":"Category Budgets"},"incomes":{"items":{"type":"object"},"type":"array","title":"Incomes"},"settings":{"additionalProperties":{"type":"string"},"type":"object","title":"Settings"},"icons":{"items":{"$ref":"#/components/schemas/IconState"},"type":"array","title":"Icons"}},"type":"object","required":["user_id"],"title":"UserState"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}
